<!--
 ~ SPDX-FileCopyrightText: Copyright DB Netz AG and the capella-collab-manager contributors
 ~ SPDX-License-Identifier: Apache-2.0
 -->

<div class="flex flex-col" *ngIf="!selectedSessions.length">
  <span
    >Please select the sessions that you'd like to open in the session
    viewer:</span
  >
  <mat-checkbox [value]="session.id" *ngFor="let session of cachedSessions"
    >{{ session.id }} ({{ session.version?.tool?.name }}
    {{ session.version?.name }})</mat-checkbox
  >
  <button mat-button (click)="selectSessions()">Open session viewer</button>
</div>
<div class="w-full height" *ngIf="selectedSessions.length" class="flex">
  <div
    class="w-full height active:z-30"
    [ngClass]="session.focused ? 'z-20' : 'z-10'"
    (click)="focusSession(session)"
    *ngFor="let session of selectedSessions"
    cdkDrag
  >
    <div
      class="flex gap-2 rounded-t p-2 cursor-grab active:cursor-grabbing items-center justify-between"
      [ngClass]="session.focused ? 'bg-slate-100' : 'bg-slate-300'"
      cdkDragHandle
    >
      <div class="flex items-center gap-2">
        <mat-icon>control_camera</mat-icon>

        {{ session.version?.tool?.name }} {{ session.version?.name }}
      </div>
      <div *ngIf="session.focused" class="flex items-center gap-2">
        <span>Focused</span><mat-icon>phonelink</mat-icon>
      </div>
      <div *ngIf="!session.focused" class="flex items-center gap-2">
        <span>Not focused</span>
        <mat-icon>phonelink_off</mat-icon>
      </div>
    </div>
    <iframe
      [id]="'session-' + session.id"
      class="w-full height"
      [src]="session.safeResourceURL"
      allow="clipboard-read; clipboard-write"
    >
    </iframe>
  </div>
</div>
